function linearFeatureMaps(Results, RF, varargin)

if nargin > 2
    number = varargin{1};
    name = varargin{2};
    fig_cmap = varargin{3};
else
    number = 13;
    name = 'Test';
    fig_cmap = 'none';
end


switch fig_cmap
    case 'mill'
        cc = [0 0 1;0.0299539156258106 0.0299539156258106 1;0.0599078312516212 0.0599078312516212 1;0.0898617506027222 0.0898617506027222 1;0.119815662503242 0.119815662503242 1;0.149769574403763 0.149769574403763 1;0.179723501205444 0.179723501205444 1;0.209677413105965 0.209677413105965 1;0.239631325006485 0.239631325006485 1;0.269585251808167 0.269585251808167 1;0.299539148807526 0.299539148807526 1;0.329493075609207 0.329493075609207 1;0.359447002410889 0.359447002410889 1;0.389400899410248 0.389400899410248 1;0.419354826211929 0.419354826211929 1;0.449308753013611 0.449308753013611 1;0.47926265001297 0.47926265001297 1;0.509216547012329 0.509216547012329 1;0.539170503616333 0.539170503616333 1;0.569124400615692 0.569124400615692 1;0.599078297615051 0.599078297615051 1;0.629032254219055 0.629032254219055 1;0.658986151218414 0.658986151218414 1;0.688940048217773 0.688940048217773 1;0.718894004821777 0.718894004821777 1;0.748847901821136 0.748847901821136 1;0.778801798820496 0.778801798820496 1;0.8087557554245 0.8087557554245 1;0.838709652423859 0.838709652423859 1;0.892473101615906 0.892473101615906 1;0.946236550807953 0.946236550807953 1;1 1 1;1 0.935483872890472 0.935483872890472;1 0.870967745780945 0.870967745780945;1 0.806451618671417 0.806451618671417;1 0.776583015918732 0.776583015918732;1 0.746714472770691 0.746714472770691;1 0.716845870018005 0.716845870018005;1 0.686977326869965 0.686977326869965;1 0.657108724117279 0.657108724117279;1 0.627240121364594 0.627240121364594;1 0.597371578216553 0.597371578216553;1 0.567502975463867 0.567502975463867;1 0.537634432315826 0.537634432315826;1 0.507765829563141 0.507765829563141;1 0.477897256612778 0.477897256612778;1 0.448028683662415 0.448028683662415;1 0.418160110712051 0.418160110712051;1 0.388291507959366 0.388291507959366;1 0.358422935009003 0.358422935009003;1 0.32855436205864 0.32855436205864;1 0.298685789108276 0.298685789108276;1 0.268817216157913 0.268817216157913;1 0.238948628306389 0.238948628306389;1 0.209080055356026 0.209080055356026;1 0.179211467504501 0.179211467504501;1 0.149342894554138 0.149342894554138;1 0.119474314153194 0.119474314153194;1 0.0896057337522507 0.0896057337522507;1 0.0597371570765972 0.0597371570765972;1 0.0298685785382986 0.0298685785382986;1 0 0];
    case 'vanila'
        cc = [0 0 1;0.02669632807374 0.02669632807374 1;0.05339265614748 0.05339265614748 1;0.0800889879465103 0.0800889879465103 1;0.10678531229496 0.10678531229496 1;0.13348163664341 0.13348163664341 1;0.160177975893021 0.160177975893021 1;0.18687430024147 0.18687430024147 1;0.21357062458992 0.21357062458992 1;0.24026694893837 0.24026694893837 1;0.266963273286819 0.266963273286819 1;0.293659627437592 0.293659627437592 1;0.320355951786041 0.320355951786041 1;0.347052276134491 0.347052276134491 1;0.373748600482941 0.373748600482941 1;0.40044492483139 0.40044492483139 1;0.42714124917984 0.42714124917984 1;0.45383757352829 0.45383757352829 1;0.48053389787674 0.48053389787674 1;0.507230222225189 0.507230222225189 1;0.533926546573639 0.533926546573639 1;0.560622870922089 0.560622870922089 1;0.587319254875183 0.587319254875183 1;0.614015579223633 0.614015579223633 1;0.640711903572083 0.640711903572083 1;0.667408227920532 0.667408227920532 1;0.694104552268982 0.694104552268982 1;0.720800876617432 0.720800876617432 1;0.747497200965881 0.747497200965881 1;0.774193525314331 0.774193525314331 1;0.887096762657166 0.887096762657166 1;1 1 1;1 0.887096762657166 0.887096762657166;1 0.774193525314331 0.774193525314331;1 0.746543765068054 0.746543765068054;1 0.718894004821777 0.718894004821777;1 0.6912442445755 0.6912442445755;1 0.663594424724579 0.663594424724579;1 0.635944664478302 0.635944664478302;1 0.608294904232025 0.608294904232025;1 0.580645143985748 0.580645143985748;1 0.552995383739471 0.552995383739471;1 0.525345623493195 0.525345623493195;1 0.497695833444595 0.497695833444595;1 0.470046073198318 0.470046073198318;1 0.442396312952042 0.442396312952042;1 0.414746522903442 0.414746522903442;1 0.387096762657166 0.387096762657166;1 0.359447002410889 0.359447002410889;1 0.331797212362289 0.331797212362289;1 0.304147452116013 0.304147452116013;1 0.276497691869736 0.276497691869736;1 0.248847916722298 0.248847916722298;1 0.221198156476021 0.221198156476021;1 0.193548381328583 0.193548381328583;1 0.165898606181145 0.165898606181145;1 0.138248845934868 0.138248845934868;1 0.11059907823801 0.11059907823801;1 0.0829493030905724 0.0829493030905724;1 0.0552995391190052 0.0552995391190052;1 0.0276497695595026 0.0276497695595026;1 0 0];
    otherwise
        cc = redblue(32);
end

if RF
    lin_slow = Results.wpRF(:,:,1);
    lin_fast = Results.wpRF(:,:,2);
    lin_control = Results.wpRF(:,:,3);
else 
    lin_slow = Results.wp(:,:,1);
    lin_fast = Results.wp(:,:,2);
    lin_control = Results.wp(:,:,3);
end
if max(abs(lin_slow(:))) > max(abs(lin_fast(:)))
    cmax1 = max(lin_slow(:));
    cmin1 = min(lin_slow(:));
else
    cmax1 = max(lin_fast(:));
    cmin1 = min(lin_fast(:));
end

if abs(cmax1) > abs(cmin1)
    cmin1 = - cmax1;
elseif abs(cmax1) < abs(cmin1)
    cmax1 = - cmin1;
end 


CL = Results.CL;
x = (1:length(CL)) - 1;

fontsize = 14
h = figure(number)
set(gca, 'Colormap', cc)
axis equal


subplot(2,2,1)
imagesc(lin_slow);
c = colorbar('TickDirection','out');
c.Label.String = 'Selectivity';
colormap(cc)
caxis([cmin1, cmax1])
% axis off
xticks([])
yticks([])
xticklabels([])
yticklabels([])
box on
xlabel('Slow Feature')
text(-0.15, 1, 'A', 'Units','normalized', 'FontSize', fontsize)

subplot(2,2,2)
imagesc(lin_fast);
xlabel('Fast Feature')
c = colorbar('TickDirection','out');
c.Label.String = 'Selectivity';
colormap(cc)
caxis([cmin1, cmax1])
box on
xticklabels([])
yticklabels([])
xticks([])
yticks([])
text(-0.15, 1, 'B', 'Units','normalized', 'FontSize', fontsize)


subplot(2,2,3)
imagesc(lin_control);
xlabel('Control Feature')
c = colorbar('TickDirection','out');
c.Label.String = 'Selectivity';
colormap()
caxis([cmin1, cmax1])
% axis off
xticks([])
yticks([])
xticklabels([])
yticklabels([])
box on
text(-0.15, 1, 'C', 'Units','normalized', 'FontSize', fontsize)

subplot(2,2,4)
plot(x, CL(:, 1:2), 'LineWidth',3);
hold on
plot(x, zeros(length(x),1), '--k', 'LineWidth', 3)
hold off
legend({'Slow feature', 'Fast feature'})
legend('boxoff')
xlabel('Neural distance (grid spacing)')
ylabel('Correlation')
text(-0.15, 1, 'D', 'Units','normalized', 'FontSize', fontsize)

saveas(h, name, 'epsc')
%saveas(h,name, 'pdf')

end
